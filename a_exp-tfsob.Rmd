---
title: "Análise Exploratória - Trabalho final de Análise de Sobrevivência"
author:
- Augusto Cesar Ribeiro Nunes - 13/0103004
- Isabela Paranhos Pinto - 11/0013450
output:
  html_document: default
---
```{r dados, echo=FALSE, message=FALSE, warnings=FALSE}
actg320 <- read.csv("actg320.dat", sep="", header = F)
names(actg320) <- c("id", "time", "censor", "time_d", "censor_d",
                    "tx", "txgrp", "strat2", "sex", "raceth",
                    "ivdrug", "hemophil", "karnof", "cd4",
                    "priorzdv", "age")
```


# Descrição
  Os dados foram obtidos por um experimento duplo-cego, controlado com  _placebo_ que comparou o tratamento com três drogas composto por indinavir (IDV), zidovudina de rótulo aberto (ZDV) ou stavudina (d4T) e lamivudina (3TC) com o tratamento com duas drogas composto por zidovudina ou stavudina e lamivudina em pacientes infectados pelo HIV. Os pacientes foram aceitos para o experimento se sua contagem de células CD4 por milímetro cúbico não excedia 200, e se tiveram pelo menos três meses de terapia prévia com zidovudina. A aleatorização foi estratificada pela contagem de células CD4 no momento da avaliação. A medida primária de resultado foi o tempo até um evento definidor de AIDS ou a morte. Resultados de eficácia a um nível de significância pré-estabelecido foram alcançados durante a execução do experimento, e por isso o mesmo foi interrompido prematuramente.
  
# Referência
* HAMMER et al. (1997), "A Controlled Trial of Two Nucleoside Analogues plus Indinavir in Persons with Human Immunodeficiency Virus Infection and CD4 Cell Counts of 200 per Cubic Millimeter or Less", The New England Journal of Medicine, http://www.nejm.org/doi/full/10.1056/NEJM199709113371101#t=article

* HOSMER, D.W. and LEMESHOW, S. e MAY, S. (2008) 
"Applied Survival Analysis: Regression Modeling of Time to Event Data: 
Second Edition", John Wiley and Sons Inc., New York, NY

# Lista de Variáveis
```{r table-simple, echo=FALSE, message=FALSE, warnings=FALSE, results='asis'}
require(pander)
panderOptions('table.split.table', Inf)
set.caption("Tabela 1: Lista de Variáveis e respectivas descrições e códigos")
meus.dados <- "  Variável       | Nome           | Descrição | Código
  1      | id | Código de Identificação |1-1156
  2      | time | Tempo até o diagnóstico de AIDS ou morte | Dias
  3      | censor | Indicador para diagnóstico de AIDS ou morte | 1 = Morte ; 0 cc.
  4      | time_d | Tempo até a morte | Dias
  5      | censor_d | Indicador para morte (somente) | 1 = Morte ; 0 cc.
  6      | tx | Indicador de Tratamento | 1 = Tratamento inclui IDV ; 0 cc.
  7      | txgrp | Indicador de Grupo de Tratamento | 1 = ZDV + 3TC; 2 = ZDV + 3TC + IDV; 3 = d4T + 3TC; 4 = d4T + 3TC + IDV
  8      | strat2 | Estrato CD4 na avaliação | 0 = CD4 <= 50 ; 1 = CD4 > 50
  9      | sex | Sexo | 1 = Homem ; 2 = Mulher
  10     | raceth | Raça/Etnia | 1 = Branco Não-Hispânico ; 2 = Negro Não-Hispânico ; 3 = Hispânico (Independentemente) ; 4 = Asiático, Ilhas do Pacífico ; 5 = Indo-Americano, Nativo do Alasca
  11     | ivdrug | Histórico de uso de droga endovenosa | 1 = Nunca; 2 = Atualmente ; 3 = Previamente
  12     | hemophil | Hemofílico | 1 = Sim; 0 = Não
  13     | karnof | Escore na Escala de Performance de Karnofsky | 100 = Normal; sem reclamação, sem evidência de doença ; 90 = Atividade Normal possível; poucos sinais/sintomas de doença ; 80 = Atividade Normal com esforço; alguns sinais/sintomas de doença ; 70 = Cuida de si mesmo; Atividade Normal/Trabalho Ativo impossível
  14     | cd4 | Contagem CD4 de Referência | Células/mililitro
  15     | priorzdv | Meses de uso prévio de ZDV | Meses
  16     | age | Idade | Anos"
df <- read.delim(textConnection(meus.dados),header=FALSE,sep="|",strip.white=TRUE,stringsAsFactors=FALSE) # inclui cabeçalho
df <- df[-1,] # remove primeira linha
row.names(df)<-NULL
pander(df, style = 'rmarkdown')
```

# Análises Exploratórias (Modelo Múltiplos Eventos)

## Tempos e Censuras sem considerar grupos
```{r an exp rc sem grupos}
require(survival)
require(AdequacyModel)
modelo1 <- survfit(Surv(time, censor) ~ 1, data =actg320)
plot(modelo1,
     main = "Estimativa (Kaplan-Meier) da Curva de Sobrevivência \n Sem considerar Grupos ", xlab = "Tempo", ylab = expression(hat(S)(t)))
TTT(actg320$time_d)
```

## De acordo com o Tratamento
```{r an exp rc tx}
modelo2 <- survfit(Surv(time, censor) ~ tx, data =actg320)
plot(modelo2,
     main = "Estimativa (Kaplan-Meier) da Curva de Sobrevivência", xlab = "Tempo", ylab = expression(hat(S)(t)), lty=c(1,2),col=c(1,2))
legend("right",cex=0.6,lty=c(1,2),c("Controle","Tratamento"),col=c(1,2))

survdiff(Surv(time, censor) ~ tx, data = actg320, rho = 1)
```

Diferença entre tratamento e controle __significativa__ a nível de 0.001

## De acordo com o Grupo de Tratamento
```{r an exp rc tipo de tx}
modelo3 <- survfit(Surv(time, censor)~txgrp, data = actg320)
plot(modelo3,
     main = "Estimativa (Kaplan-Meier) da Curva de Sobrevivência", xlab = "Tempo", ylab = expression(hat(S)(t)), lty=c(1,2,3,4),col=c(1,2,3,4))
legend("right",cex=0.6,lty=c(1,2,3,4),c("ZDV + 3TC", "ZDV + 3TC + IDV", "d4T + 3TC", "d4T + 3TC + IDV"),col=c(1,2,3,4))


survdiff(Surv(time, censor) ~ txgrp, data = actg320, rho = 1)
```

Diferença entre grupos de tratamento __significativa__ a nível de 0.01

## De acordo com o estrato de contagem de células CD4
```{r an exp rc}
modelo4 <- survfit(Surv(time, censor)~ strat2, data = actg320)
plot(modelo4,
     main = "Estimativa (Kaplan-Meier) da Curva de Sobrevivência", xlab = "Tempo", ylab = expression(hat(S)(t)), lty=c(1,2),col=c(1,2))
legend("right",cex=0.6,lty=c(1,2),c("CD4 <= 50", "CD4 > 50"),col=c(1,2))

survdiff(Surv(time, censor) ~ strat2, data = actg320, rho = 1)
```

Diferença entre estratos de contagem de células CD4 __significativa__ a nível de $10^{-11}$.

## De acordo com o sexo
```{r an exp rc sexo}
modelo5 <- survfit(Surv(time, censor) ~ sex, data = actg320)
plot(modelo5,
     main = "Estimativa (Kaplan-Meier) da Curva de Sobrevivência", xlab = "Tempo", ylab = expression(hat(S)(t)), lty=c(1,2),col=c(1,2))
legend("right",cex=0.6,lty=c(1,2),c("Masculino", "Feminino"),col=c(1,2))


survdiff(Surv(time, censor) ~ sex, data = actg320, rho = 1)

```

Diferença entre sexos __não significativa__.

## De acordo com a raça/etnia
```{r an exp rc raca}
modelo6 <- survfit(Surv(time, censor)~raceth, data = actg320)
plot(modelo6,
     main = "Estimativa (Kaplan-Meier) da Curva de Sobrevivência", xlab = "Tempo", ylab = expression(hat(S)(t)), lty=c(1,2,3,4,5),col=c(1,2,3,4,5))
legend("right",cex=0.6,lty=c(1,2,3,4,5),c("Branco Não-Hispânico", "Negro Não-Hispânico", "Hispânico (Independentemente)", "Asiático, Ilhas do Pacífico", "Indo-Americano, Nativo do Alasca"),col=c(1,2,3,4,5))

survdiff(Surv(time, censor) ~ raceth, data = actg320, rho = 1)
```

Diferença entre raças/etnias __não-significativa__. 

## De acordo com o uso de drogas endovenosas
```{r}
modelo7 <- survfit(Surv(time, censor) ~ ivdrug, data = actg320)
plot(modelo7,
     main = "Estimativa (Kaplan-Meier) da Curva de Sobrevivência \n Quanto ao uso de Drogas Endovenosas", xlab = "Tempo", ylab = expression(hat(S)(t)), lty=c(1,2,3),col=c(1,2,3))
legend("right",cex=0.6,lty=c(1,2,3),c("Nunca", "Atualmente", "Previamente"),col=c(1,2,3))

survdiff(Surv(time, censor) ~ ivdrug, data = actg320, rho = 1)
```

Diferença entre utilização de drogas endovenosas __não-significativa__. Poucos casos (4) na categoria "Atualmente".

## De acordo com a hemofilia
```{r an exp RC hemofilia}
modelo8 <- survfit(Surv(time, censor) ~ hemophil, data = actg320)
plot(modelo8,
     main = "Estimativa (Kaplan-Meier) da Curva de Sobrevivência", xlab = "Tempo", ylab = expression(hat(S)(t)), lty=c(1,2),col=c(1,2))
legend("right",cex=0.6,lty=c(1,2),c("Hemofílico", "Não Hemofílico"),col=c(1,2))

survdiff(Surv(time, censor) ~ hemophil, data = actg320, rho = 1)
```

Diferença entre hemofílicos e não-hemofílicos __não-significativa__.

## De acordo com o escore na Escala de Performance de Karnofsky
```{r an exp RC karnofsky}
modelo9 <- survfit(Surv(time, censor) ~ karnof, data = actg320)
plot(modelo9,
     main = "Estimativa (Kaplan-Meier) da Curva de Sobrevivência", xlab = "Tempo", ylab = expression(hat(S)(t)), lty=c(1,2,3,4),col=c(1,2,3,4))
legend("right",cex=0.6,lty=c(1,2,3,4),c("Normal", "Atividade Normal possível", "Atividade Normal com esforço", "Cuida de si mesmo"),col=c(1,2,3,4))

survdiff(Surv(time, censor) ~ karnof, data = actg320, rho = 1)
```

Diferença entre as curvas de sobrevivência os escores da Escala de Performance de Karnof __significativa__.


# Análises Exploratórias (Modelo Simples)
```{r medidas e graficos}
# Quantis
quantile(actg320$time_d)
quantile(actg320$time_d[which(actg320$censor_d==0)])
quantile(actg320$time_d[which(actg320$censor_d==1)])

# Médias
mean(actg320$time_d)
mean(actg320$time_d[which(actg320$censor_d==0)])
mean(actg320$time_d[which(actg320$censor_d==1)])

# Gráfico Kernel
plot(density(actg320$time_d), main = "Densidade Kernel para a variável tempo")
lines(density(actg320$time_d[which(actg320$censor_d==1)]), lty=2, col = 2)
lines(density(actg320$time_d[which(actg320$censor_d==0)]), lty=3, col = 3)
legend("left", lty=c(1,2,3), col = c(1,2,3), c("Geral", "Falha", "Censurados"))

```



```{r an exp   sem grupos}
require(survival)
modelo1 <- survfit(Surv(time_d, censor_d) ~ 1, data = actg320)
plot(modelo1,
     main = "Estimativa (Kaplan-Meier) da Curva de Sobrevivência \n Sem considerar Grupos ", xlab = "Tempo", ylab = expression(hat(S)(t)),
     mark.time = T, conf.int= F)

curvaTTT <- function(tempo) {
  G_rn <- numeric()
  for (i in 1:length(tempo)) {
    G_rn[i] <-
      (sum(sort(tempo)[1:i]) + (length(tempo) - i) * sort(tempo)[i]) / (sum(tempo))
  }
  rn <- seq_along(tempo)/length(tempo)
  plot(G_rn ~ rn,
       main = "Curva TTT \n(Tempo Total em Teste)",
       ylab = "G(r/n)",
       xlab = "r/n")
  abline(0,1)
}

curvaTTT(actg320$time_d)
```

## De acordo com o Tratamento
```{r an exp   tx}
modelo2 <- survfit(Surv(time_d, censor_d) ~ factor(tx), data =actg320)
plot(modelo2,
     main = "Estimativa (Kaplan-Meier) da Curva de Sobrevivência", xlab = "Tempo", ylab = expression(hat(S)(t)), lty=c(1,2),col=c(1,2))
legend("right",cex=0.6,lty=c(1,2),c("Controle","Tratamento"),col=c(1,2))

survdiff(Surv(time_d, censor_d) ~ tx, data = actg320, rho = 1)

df.tx <- data.frame(actg320$time_d, actg320$tx)

tx0 <- df.tx[df.tx$actg320.tx == 0,]
TTT(tx0$actg320.time_d)

tx1 <- df.tx[df.tx$actg320.tx == 1,]
TTT(tx1$actg320.time_d)
```

Diferença entre tratamento e controle __significativa__ 

## De acordo com o Grupo de Tratamento
```{r an exp tipo de tx}
modelo3 <- survfit(Surv(time_d, censor_d)~txgrp, data = actg320)
plot(modelo3,
     main = "Estimativa (Kaplan-Meier) da Curva de Sobrevivência", xlab = "Tempo", ylab = expression(hat(S)(t)), lty=c(1,2,3,4),col=c(1,2,3,4))
legend("right",cex=0.6,lty=c(1,2,3,4),c("ZDV + 3TC", "ZDV + 3TC + IDV", "d4T + 3TC", "d4T + 3TC + IDV"),col=c(1,2,3,4))


survdiff(Surv(time_d, censor_d) ~ txgrp, data = actg320, rho = 1)

df.txgrp <- data.frame(actg320$time_d, actg320$txgrp)

df.txgrp1 <- df.txgrp[df.txgrp$actg320.txgrp == 1,]
TTT(df.txgrp1$actg320.time_d)

df.txgrp2 <- df.txgrp[df.txgrp$actg320.txgrp == 2,]
TTT(df.txgrp2$actg320.time_d)

# df.txgrp3 <- df.txgrp[df.txgrp$actg320.txgrp == 3,]
# TTT(df.txgrp3$actg320.time_d)
# erro pois n = 1

df.txgrp4 <- df.txgrp[df.txgrp$actg320.txgrp == 4,]
TTT(df.txgrp4$actg320.time_d)
# Não informativo pois n = 2
```

Diferença entre grupos de tratamento __significativa__ a nível de 0.25

## De acordo com o estrato de contagem de células CD4
```{r an exp strat2}
modelo4 <- survfit(Surv(time_d, censor_d)~ strat2, data = actg320)
plot(modelo4,
     main = "Estimativa (Kaplan-Meier) da Curva de Sobrevivência", xlab = "Tempo", ylab = expression(hat(S)(t)), lty=c(1,2),col=c(1,2))
legend("right",cex=0.6,lty=c(1,2),c("CD4 <= 50", "CD4 > 50"),col=c(1,2))

survdiff(Surv(time_d, censor_d) ~ strat2, data = actg320, rho = 1)

df.strat2 <- data.frame(actg320$time_d, actg320$strat2)

df.strat2.0 <- df.strat2[df.strat2$actg320.strat2 == 0,]
TTT(df.strat2.0$actg320.time_d)

df.strat2.1 <- df.strat2[df.strat2$actg320.strat2 == 1,]
TTT(df.strat2.1$actg320.time_d)
```

Diferença entre estratos de contagem de células CD4 __significativa__ a nível de $10^{-11}$.

## De acordo com o sexo
```{r an exp   sexo}
modelo5 <- survfit(Surv(time_d, censor_d) ~ sex, data = actg320)
plot(modelo5,
     main = "Estimativa (Kaplan-Meier) da Curva de Sobrevivência", xlab = "Tempo", ylab = expression(hat(S)(t)), lty=c(1,2),col=c(1,2))
legend("right",cex=0.6,lty=c(1,2),c("Masculino", "Feminino"),col=c(1,2))


survdiff(Surv(time_d, censor_d) ~ sex, data = actg320, rho = 1)

df.sex <- data.frame(actg320$time_d, actg320$sex)

df.sex1 <- df.sex[df.sex$actg320.sex == 1,]
TTT(df.sex1$actg320.time_d)

df.sex2 <- df.sex[df.sex$actg320.sex == 2,]
TTT(df.sex2$actg320.time_d)
```

Diferença entre sexos __não significativa__.

## De acordo com a raça/etnia
```{r an exp   raca}
modelo6 <- survfit(Surv(time_d, censor_d)~raceth, data = actg320)
plot(modelo6,
     main = "Estimativa (Kaplan-Meier) da Curva de Sobrevivência", xlab = "Tempo", ylab = expression(hat(S)(t)), lty=c(1,2,3,4,5),col=c(1,2,3,4,5))
legend("right",cex=0.6,lty=c(1,2,3,4,5),c("Branco Não-Hispânico", "Negro Não-Hispânico", "Hispânico (Independentemente)", "Asiático, Ilhas do Pacífico", "Indo-Americano, Nativo do Alasca"),col=c(1,2,3,4,5))

survdiff(Surv(time_d, censor_d) ~ raceth, data = actg320, rho = 1)

df.raceth <- data.frame(actg320$time_d, actg320$raceth)

df.raceth1 <- df.raceth[df.raceth$actg320.raceth == 1,]
TTT(df.raceth1$actg320.time_d)

df.raceth2 <- df.raceth[df.raceth$actg320.raceth == 2,]
TTT(df.raceth2$actg320.time_d)

df.raceth3 <- df.raceth[df.raceth$actg320.raceth == 3,]
TTT(df.raceth3$actg320.time_d)

df.raceth4 <- df.raceth[df.raceth$actg320.raceth == 4,]
TTT(df.raceth4$actg320.time_d)
# poucas obs. (14)

df.raceth5 <- df.raceth[df.raceth$actg320.raceth == 5,]
TTT(df.raceth5$actg320.time_d)
# poucas obs. (11)

```

Diferença entre raças/etnias __significativa__. 

## De acordo com o uso de drogas endovenosas
```{r}
modelo7 <- survfit(Surv(time_d, censor_d) ~ ivdrug, data = actg320)
plot(modelo7,
     main = "Estimativa (Kaplan-Meier) da Curva de Sobrevivência \n Quanto ao uso de Drogas Endovenosas", xlab = "Tempo", ylab = expression(hat(S)(t)), lty=c(1,2,3),col=c(1,2,3))
legend("right",cex=0.6,lty=c(1,2,3),c("Nunca", "Atualmente", "Previamente"),col=c(1,2,3))

survdiff(Surv(time_d, censor_d) ~ ivdrug, data = actg320, rho = 1)

df.ivdrug <- data.frame(actg320$time_d, actg320$ivdrug)

df.ivdrug1 <- df.ivdrug[df.ivdrug$actg320.ivdrug == 1,]
TTT(df.ivdrug1$actg320.time_d)

df.ivdrug2 <- df.ivdrug[df.ivdrug$actg320.ivdrug == 2,]
TTT(df.ivdrug2$actg320.time_d)
# nobs = 4

df.ivdrug3 <- df.ivdrug[df.ivdrug$actg320.ivdrug == 3,]
TTT(df.ivdrug3$actg320.time_d)
```

Diferença entre utilização de drogas endovenosas __significativa__. Poucos casos (4) na categoria "Atualmente".

## De acordo com a hemofilia
```{r an exp   hemofilia}
modelo8 <- survfit(Surv(time_d, censor_d) ~ hemophil, data = actg320)
plot(modelo8,
     main = "Estimativa (Kaplan-Meier) da Curva de Sobrevivência", xlab = "Tempo", ylab = expression(hat(S)(t)), lty=c(1,2),col=c(1,2))
legend("right",cex=0.6,lty=c(1,2),c("Hemofílico", "Não Hemofílico"),col=c(1,2))

survdiff(Surv(time_d, censor_d) ~ hemophil, data = actg320, rho = 1)

df.hemophil <- data.frame(actg320$time_d, actg320$hemophil)

df.hemophil0 <- df.hemophil[df.hemophil$actg320.hemophil == 0,]
TTT(df.hemophil0$actg320.time_d)

df.hemophil1 <- df.hemophil[df.hemophil$actg320.hemophil == 1,]
TTT(df.hemophil1$actg320.time_d)
#nobs = 35
```

Diferença entre hemofílicos e não-hemofílicos __não-significativa__.

## De acordo com o escore na Escala de Performance de Karnofsky
```{r an exp karnofsky}
modelo9 <- survfit(Surv(time_d, censor_d) ~ factor(karnof), data = actg320)
plot(modelo9,
     main = "Estimativa (Kaplan-Meier) da Curva de Sobrevivência", xlab = "Tempo", ylab = expression(hat(S)(t)), lty=c(1,2,3,4),col=c(1,2,3,4))
legend("right",cex=0.6,lty=c(1,2,3,4),c("Normal", "Atividade Normal possível", "Atividade Normal com esforço", "Cuida de si mesmo"),col=c(1,2,3,4))

survdiff(Surv(time_d, censor_d) ~ factor(karnof), data = actg320, rho = 1)

df.karnof <- data.frame(actg320$time_d, actg320$karnof)

df.karnof70 <- df.karnof[df.karnof$actg320.karnof == 70,]
TTT(df.karnof70$actg320.time_d)
#nobs = 32

df.karnof80 <- df.karnof[df.karnof$actg320.karnof == 80,]
TTT(df.karnof80$actg320.time_d)

df.karnof90 <- df.karnof[df.karnof$actg320.karnof == 90,]
TTT(df.karnof90$actg320.time_d)

df.karnof100 <- df.karnof[df.karnof$actg320.karnof == 100,]
TTT(df.karnof100$actg320.time_d)
```

Diferença entre as curvas de sobrevivência os escores da Escala de Performance de Karnof __significativa__.

## De acordo com a contagem de referência de células CD4
```{r an exp cd4}
modelo10 <- survfit(Surv(time_d, censor_d) ~ cd4, data = actg320)
```

#Achados exploratórios

## Curva TTT

Sugere a utilização de uma distribuição cuja curva de risco tenha formato crescente.

## Variáveis significativas a um nível de 0.25

1. Escore de Karnof ($\approx 10^{-7}$)
2. Estrato de contagem de células CD4 ($\approx 10^{-3}$)
3. Raça/Etnia
4. Tratamento
5. Grupo de Tratamento

# "Conclusão" Análise Exploratória

Utilizar Modelo Weibull com $\gamma > 1$?

# Modelagem Paramétrica (Weibull)
```{r}
mwe <- survreg(Surv(actg320$time_d, actg320$censor_d) ~ 1, dist = "weibull")
summary(mwe)

alphaw <- exp(mwe$coefficients[1])
gammaw <- 1/mwe$scale

pws <- 2
AICws <- (-2*mwe$loglik[1])+2*pws

AICcws <- AICws + ((2*pws*(pws+1))/(length(actg320$time_d)-pws-1))

BICws<-(-2*mwe$loglik[1]) + pws*log(length(actg320$time_d))

medidasw<-cbind(AICws,AICcws,BICws)
medidasw
```

# Modelagem paramétrica (logNormal)
```{r}
mlognorm<-survreg(Surv(actg320$time_d,actg320$censor_d)~1, dist='lognorm')
mlognorm

mi<-mlognorm$coefficients[1]
sigma<-mlognorm$scale

plns<-2
AIClns<-(-2*mlognorm$loglik[1])+(2*plns)

AICclns<-AIClns + ((2*pws*(pws+1))/(length(actg320$time_d)-plns-1))

BIClns<-(-2*mlognorm$loglik[1]) + plns*log(length(actg320$time_d))

medidasln<-cbind(AIClns,AICclns,BIClns)
medidasln

```

# Modelagem Paramétrica (log-Logística)
```{r}
mloglogi<-survreg(Surv(actg320$time_d,actg320$censor_d)~1, dist='loglogistic')
mloglogi

alphall<-exp(mloglogi$coefficients[1])
alphall

gamall<- 1/mloglogi$scale
gamall

plls<-2
AIClls<-(-2*mloglogi$loglik[1])+(2*plls)

AICclls<-AIClls + ((2*pws*(pws+1))/(length(actg320$time_d)-plls-1))

BIClls<-(-2*mloglogi$loglik[1]) + plls*log(length(actg320$time_d))

medidasll<-cbind(AIClls,AICclls,BIClls)
medidasll
```

# Medidas de informação modelos paramétricos
```{r medidas de info}
rbind(medidasw, medidasln, medidasll)
```

# Gráfico Kaplan-Meier versus Modelos Paramétricos
```{r km versus modelos}
km<-survfit(Surv(actg320$time_d, actg320$censor_d)~1)
time<-km$time         ### tempo de KM ###
#time

skm<-km$surv     ###  sobrevivência de Kaplan-Meier ###
#skm

swe<-exp(-(time/alphaw)^gammaw)  ###  sobrevivencia do modelo weibull ###

slognorm<-pnorm((-log(time)+mi)/sigma)   ###  sobrevivencia do modelo log-normal ###

sloglogi<-1/(1+(time/alphall)^gamall)  ###  sobrevivencia do modelo log-log?stico ###

#par(mfrow=c(1,1))
plot(km,conf.int=F, xlab="Tempos", ylab="S(t)")
lines(c(0,time),c(1,swe),lty=2,col=2)
legend(18,0.4,lty=c(1,2),col=c(1,2),c("Kaplan-Meier","Weibull"),bty="n",cex=0.8)
lines(c(0,time),c(1,slognorm),lty=4,col=4)
legend(18,0.3,lty=4,col=4,c("Log-Normal"),bty="n",cex=0.8)
lines(c(0,time),c(1,sloglogi),lty=5,col=6)
legend(18,0.2,lty=5,col=6,c("Log-Logística"),bty="n",cex=0.8)
```


# Modelo de Regressão

